# ══════════════════════════════════════════════════════════════════════════════
# PAGI Ecosystem – Environment Variables
# ══════════════════════════════════════════════════════════════════════════════
# Copy this file to `.env` in the project root.
# All LLM calls are routed through the Rust backend (pagi-gateway).
# The frontend has NO API keys – it only talks to the backend.
#
# Port Ranges (Architecture Standard):
#   Backend/API: 8000-8099 (Gateway on 8000)
#   Frontend/UI: 3001-3099
# ══════════════════════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────────────────
# RUST LOGGING
# ─────────────────────────────────────────────────────────────────────────────
# Log level: error, warn, info, debug, trace
# Can also filter by crate: RUST_LOG=pagi_gateway=debug,pagi_core=info
RUST_LOG=info

# ─────────────────────────────────────────────────────────────────────────────
# PAGI CORE CONFIGURATION
# ─────────────────────────────────────────────────────────────────────────────
# Path to the gateway TOML config (without extension)
# Default: config/gateway (loads config/gateway.toml)
PAGI_CONFIG=config/gateway

# Path to the orchestrator blueprint JSON
# Default: config/blueprint.json
PAGI_BLUEPRINT_PATH=config/blueprint.json

# ─────────────────────────────────────────────────────────────────────────────
# PAGI CONFIG OVERRIDES (PAGI__* pattern)
# ─────────────────────────────────────────────────────────────────────────────
# Any gateway.toml setting can be overridden via PAGI__<KEY>=<value>
# Examples:
# PAGI__PORT=8002
# PAGI__STORAGE_PATH=./custom_data
# PAGI__FRONTEND_ENABLED=false
# PAGI__LLM_MODE=live

# ─────────────────────────────────────────────────────────────────────────────
# LLM PROVIDER (OpenRouter - Default)
# ─────────────────────────────────────────────────────────────────────────────
# LLM invocation mode: "mock" (simulated responses) or "live" (real API calls)
PAGI_LLM_MODE=mock

# OpenRouter API endpoint (default LLM gateway)
# Docs: https://openrouter.ai/docs
PAGI_LLM_API_URL=https://openrouter.ai/api/v1/chat/completions

# OpenRouter API key (required when PAGI_LLM_MODE=live; also used by OpenRouter Sovereign Bridge)
# Get yours at: https://openrouter.ai/keys
# Bridge (high-level planning) uses OPENROUTER_API_KEY; chat uses PAGI_LLM_API_KEY (fallback: OPENROUTER_API_KEY)
PAGI_LLM_API_KEY=
OPENROUTER_API_KEY=

# Recommended OpenRouter Models (select one for PAGI_LLM_MODEL):
# 1. anthropic/claude-opus-4.6 - Best for agentic AGI; high performance, 1M context, $5/$25 per 1M tokens.
# 2. moonshot/kimi-k2.5 - Multimodal reasoning, 262K context, $0.45/$2.25.
# 3. qwen/qwen3-coder-next - Coding-focused, efficient, 262K context, $0.07/$0.30.
# 4. arcee-ai/trinity-large-preview - Free, adaptive MoE, 131K context, $0/$0.
# 5. writer/palmyra-x5 - Massive context, 1.04M tokens, $0.60/$6.
# 6. stepfun/step-3.5-flash - Free, fast reasoning, 256K context, $0/$0.
# 7. upstage/solar-pro-3 - Free, multilingual, 128K context, $0/$0.
# 8. openrouter/pony-alpha - Free, coding agents, 200K context, $0/$0.
# Choose based on AGI needs vs. cost; API key required from https://openrouter.ai/keys
PAGI_LLM_MODEL=anthropic/claude-opus-4.6

# ─────────────────────────────────────────────────────────────────────────────
# ALTERNATIVE LLM PROVIDERS (Optional)
# ─────────────────────────────────────────────────────────────────────────────
# To use a different provider, change PAGI_LLM_API_URL:
#
# OpenAI Direct:
#   PAGI_LLM_API_URL=https://api.openai.com/v1/chat/completions
#   PAGI_LLM_API_KEY=sk-...
#
# Anthropic Direct:
#   PAGI_LLM_API_URL=https://api.anthropic.com/v1/messages
#   PAGI_LLM_API_KEY=sk-ant-...
#
# Groq (fast inference):
#   PAGI_LLM_API_URL=https://api.groq.com/openai/v1/chat/completions
#   PAGI_LLM_API_KEY=gsk_...
#
# Ollama (local):
#   PAGI_LLM_API_URL=http://localhost:11434/v1/chat/completions
#   PAGI_LLM_API_KEY=   (leave empty)
#
# Together AI:
#   PAGI_LLM_API_URL=https://api.together.xyz/v1/chat/completions
#   PAGI_LLM_API_KEY=...

# ─────────────────────────────────────────────────────────────────────────────
# MOE & GATER (Mixture of Experts – visible and toggleable in Settings UI)
# ─────────────────────────────────────────────────────────────────────────────
# Default MoE mode when Sovereign Config (KB-6) has no saved value: "dense" or "sparse".
# After first run, the UI toggle persists to KB-6; this only applies before any toggle.
PAGI_MOE_DEFAULT=dense

# Number of recent Chronos events used to build local context for the Gater (Sparse mode).
# Higher = more context for routing; 20 is a good balance.
PAGI_LOCAL_CONTEXT_LIMIT=20

# Autonomous heartbeat tick interval (seconds). Minimum 1.
# PAGI_TICK_RATE_SECS=5

# ─────────────────────────────────────────────────────────────────────────────
# ORCHESTRATOR ROLE (Sovereign Base – Counselor-Architect)
# ─────────────────────────────────────────────────────────────────────────────
# Core system role: "counselor" (default). Counselor is the functional layer for guidance and boundary management.
# Legacy: CORE_SYSTEM_ROLE or PAGI_MODE. API: GET/POST /api/v1/settings/orchestrator-role
CORE_SYSTEM_ROLE=counselor
PAGI_MODE=counselor

# Context density: "concise" (RLM/sovereign), "balanced" (default), or "verbose" (counselor). Affects token use and response style.
# Toggle also via API: GET/POST /api/v1/settings/density
# PAGI_DENSITY_MODE=balanced

# ─────────────────────────────────────────────────────────────────────────────
# ASTRO-LOGIC TRIAD (Sun / Moon / Rising)
# ─────────────────────────────────────────────────────────────────────────────
# These optional values let the Counselor-Architect tune output (Sun), internal processing (Moon),
# and boundary/interface posture (Rising/Ascendant).
#
# Preferred keys (Wave-1 distribution):
PAGI_SUN_SIGN=
PAGI_MOON_SIGN=
PAGI_ASCENDANT_SIGN=
#
# Legacy aliases still supported by the loader (do not set both):
# PAGI_USER_SIGN=aries
# PAGI_ASCENDANT=leo

# Jungian shadow-work focus for self-sabotage protection. Maps to KB-6 (Ethos).
# PAGI_JUNGIAN_SHADOW_FOCUS=perfectionism

# Advisor tone overlay (Archetype Gallery): pisces | virgo | scorpio | libra | cancer | capricorn | leo.
# pisces = Advisor (empathetic), virgo = Architect (technical), capricorn = Strategist (career/goals). Default: pisces.
PAGI_PRIMARY_ARCHETYPE=pisces
# Optional secondary overlay to blend (e.g. virgo for structured/practical balance).
PAGI_SECONDARY_ARCHETYPE=virgo
# When set, overrides primary/secondary for this run (e.g. task-based shift). Leave unset for normal behavior.
# PAGI_ARCHETYPE_OVERRIDE=

# Archetype Auto-Switch: when true, Phoenix suggests overlay from query domain (Technical→Virgo, Emotional→Pisces, Strategic→Capricorn).
# KB-01 override: if user_profile has tone_preference "Strictly Technical", archetype_auto_switch false, or always_direct true, auto-switch is disabled regardless of this env.
PAGI_ARCHETYPE_AUTO_SWITCH=true

# ─────────────────────────────────────────────────────────────────────────────
# PHOENIX WARDEN — Sovereign Config Toggles (Astro-Logic & 3-Tier Firewall)
# ─────────────────────────────────────────────────────────────────────────────
# GET /api/v1/config/status returns which layers are active. Toggle "hardness"
# of the firewall without touching code.

# When true, blocks ALL non-Core (Tier 2/3) skills from any KB access at dispatch.
# Only Tier 1 (Core) skills may touch KB-01..KB-09. Default: false.
PAGI_FIREWALL_STRICT_MODE=false

# Apply archetype directives from KB-01 (Pisces/Savior, tone overrides). When false, process_archetype_triggers returns empty.
PAGI_ASTRO_LOGIC_ENABLED=true

# Astro-Transit scraper (on-boot + background refresh every 6h). Alias: PAGI_TRANSIT_ALERTS_ENABLED.
PAGI_ASTRO_ALERTS_ENABLED=true
# Legacy name (same effect):
# PAGI_TRANSIT_ALERTS_ENABLED=true

# KB-05 social defense ranking from sovereignty_leak_triggers. Alias: PAGI_SOVEREIGNTY_AUTO_RANK_ENABLED.
PAGI_SOVEREIGNTY_AUTO_RANK=true
# PAGI_SOVEREIGNTY_AUTO_RANK_ENABLED=true

# Allow skill promotion without confirmed: true (human-in-the-loop). When false, Promote in WardenSidebar requires confirmation.
PAGI_SKILLS_AUTO_PROMOTE_ALLOWED=false

# Audit successes (e.g. Failed Leak Attempt) to KB-08 (Soma). When false, record_success_metric is not called.
PAGI_KB08_SUCCESS_LOGGING=true

# KB-08 success metric verbosity: "minimal" | "full". Controls how much is logged for health report / audit trail.
PAGI_KB08_LOGGING_LEVEL=full

# Force temperature 0.3 for all chat/stream regardless of user or archetype input.
PAGI_STRICT_TECHNICAL_MODE=false

# On first user interaction of the day, prepend a short morning briefing (transit + energy habits). Set to false to disable.
PAGI_DAILY_CHECKIN_ENABLED=true

# After this hour (0–23, UTC), show evening audit question once per day. Submit via POST /api/v1/evening-audit. Set to false to disable.
PAGI_EVENING_AUDIT_ENABLED=true
# Hour (UTC) when evening audit may appear. Default: 18 (6 PM UTC).
PAGI_AUDIT_START_HOUR=18

# When true, use Microsoft Graph (Viva Insights) for Schedule Outlook in morning briefing and Gatekeeper mode (shorter responses during Focus/Quiet time). Requires MS_GRAPH_* below.
PAGI_FOCUS_SHIELD_ENABLED=false
# Vitality Shield: when true, fetch sleep/activity from MS Graph Beta (or KB-08). If sleep < 6h, Phoenix reduces emotional load and biases toward Virgo/Architect. Requires MS_GRAPH_* and optional wellness/sleep scope.
MS_GRAPH_HEALTH_ENABLED=false
# Microsoft Graph (app registration). OAuth tokens stored in KB-04 (Chronos); never logged.
# MS_GRAPH_USER_UPN: user's UPN for app-only calendar access (e.g. user@contoso.com). Omit to disable calendar fetch.
# MS_GRAPH_CLIENT_ID=
# MS_GRAPH_TENANT_ID=
# MS_GRAPH_CLIENT_SECRET=
# MS_GRAPH_USER_UPN=

# Humanity Slider (0.0–1.0): 1.0 = Pure Archetype (Pisces tone), 0.0 = Pure Architect (dry, technical). Default 0.7. When in Focus/Quiet time, ratio is temporarily reduced by 0.4.
# PAGI_HUMANITY_RATIO=0.7

# ─────────────────────────────────────────────────────────────────────────────
# FEATURE: SOVEREIGN PROTOCOLS (KB-05 – Gated Social Protection)
# ─────────────────────────────────────────────────────────────────────────────
# Enable Sovereign Security Protocols for domain protection against manipulation.
# When enabled (and UI toggle is on), applies Gray Rock/Professional communication styles
# based on subject rank from KB-02. Set to false to disable backend protocol engine.
SOVEREIGN_PROTOCOLS_ENABLED=false

# Default subject rank (0–10) when KB-02 has no identified subject. Higher = more defensive protocol.
# When System Vitality is "draining", rank 0–4 is escalated to Gray Rock automatically.
# PAGI_DEFAULT_SUBJECT_RANK=5

# ─────────────────────────────────────────────────────────────────────────────
# SOVEREIGN IDENTITY & VOICE (PHOENIX MARIE / SAO)
# ─────────────────────────────────────────────────────────────────────────────
# Public persona name returned by /api/v1/health and used in UI. All caps: PHOENIX MARIE.
PAGI_IDENTITY_NAME=PHOENIX MARIE

# Voice (STT/TTS) — Production backends for pagi-voice (run_voice_loop).
# TTS: OpenAI-compatible speech endpoint. Default: https://api.openai.com/v1
# TTS_API_URL=https://api.openai.com/v1
# TTS_API_KEY=   (or set PAGI_LLM_API_KEY / OPENROUTER_API_KEY)
# TTS_MODEL=tts-1
# Voice is selected from PAGI_PRIMARY_ARCHETYPE (e.g. pisces→shimmer, virgo→nova).
#
# STT: OpenAI-compatible transcription endpoint. Default: https://api.openai.com/v1
# STT_API_URL=https://api.openai.com/v1
# STT_API_KEY=   (or PAGI_LLM_API_KEY / OPENROUTER_API_KEY)
# STT_MODEL=whisper-1
#
# Local Whisper STT (pagi-voice with --features whisper): path to ggml .bin model.
# Download from https://huggingface.co/ggerganov/whisper.cpp (e.g. ggml-base.en.bin).
# WHISPER_MODEL_PATH=/path/to/ggml-base.en.bin

# Identity mode for the core orchestrator: Counselor (default). Injects the Counselor-Architect SAO meta-prompt.
PAGI_IDENTITY_MODE=Counselor

# Verbosity / tone: Candid = peer-to-peer, avoid "AI language"; Reserved = more formal.
PAGI_VERBOSITY=Candid

# When true, skip PHOENIX MARIE onboarding overlay (needs_onboarding=false). Use for development speed.
PAGI_SKIP_ONBOARDING=false

# ─────────────────────────────────────────────────────────────────────────────
# SOVEREIGN CONFIGURATION (Counselor-Architect / Therapeutic Core)
# ─────────────────────────────────────────────────────────────────────────────
# Core role: counselor (mental health, sovereignty, cognitive protection). Future: vertical-specific binaries.
# PAGI_CORE_MODE=counselor
# Default capacity for vitality (e.g. 100.0). Used with load in config for status.
# PAGI_DEFAULT_CAPACITY=100.0
# Social defense level 0–10 (5 = standard protective stance). Informs protocol baseline.
# PAGI_SOCIAL_DEFENSE_LEVEL=5
# Optional. Set in config/gateway.toml under [sovereign_attributes] (or domain_attributes): capacity, load, status.
# GET /api/v1/domain/vitality returns vitality: stable | draining | critical.

# ─────────────────────────────────────────────────────────────────────────────
# FEATURE: FILE SYSTEM & PATHS (customize in .env; also visible in Settings UI)
# ─────────────────────────────────────────────────────────────────────────────
# Enable file system access (read_file, workspace analysis, sandbox write). Set to false to disable.
PAGI_FS_ACCESS_ENABLED=true

# Root path for file operations (read_file, fs_workspace_analyzer). Empty = current working directory.
# Use an absolute path to restrict PAGI to a specific folder (e.g. your project root).
# PAGI_FS_ROOT=C:/Users/You/projects/my-repo

# Optional: research_sandbox location (default: <cwd>/research_sandbox). write_sandbox_file uses this.
# PAGI_RESEARCH_SANDBOX_PATH=./research_sandbox

# ─────────────────────────────────────────────────────────────────────────────
# RED-TEAM PEER REVIEW (Phase 4.75 – Adversarial Consensus)
# ─────────────────────────────────────────────────────────────────────────────
# Model used for adversarial security review of proposed patches.
# For true multi-agent consensus, use a DIFFERENT model than PAGI_LLM_MODEL.
# Examples: "gpt-4o", "meta-llama/llama-3.3-70b-instruct", "anthropic/claude-sonnet-4"
# PAGI_REDTEAM_MODEL=meta-llama/llama-3.3-70b-instruct

# API endpoint for the Red-Team reviewer (OpenRouter-compatible).
# PAGI_REDTEAM_API_URL=https://openrouter.ai/api/v1/chat/completions

# API key for the Red-Team reviewer (falls back to PAGI_LLM_API_KEY / OPENROUTER_API_KEY).
# Set a separate key if using a different provider for the reviewer.
# PAGI_REDTEAM_API_KEY=

# ─────────────────────────────────────────────────────────────────────────────
# FORGE SAFETY GOVERNOR (Human-in-the-Loop Approval for Self-Modification)
# ─────────────────────────────────────────────────────────────────────────────
# When true (default), Phoenix must request your approval before compiling any
# self-generated code. When false, Phoenix can autonomously compile and load
# new skills without human authorization (AUTONOMOUS EVOLUTION MODE).
#
# ⚠️  WARNING: Setting this to false removes the HITL safety gate. Only disable
# in controlled testing environments where you trust Phoenix's judgment.
#
# All approval/denial events are logged to KB-08 (Soma) regardless of this setting.
PAGI_FORGE_SAFETY_ENABLED=true

# ─────────────────────────────────────────────────────────────────────────────
# SLOT 4 — EXTERNAL GATEWAY (web search)
# ─────────────────────────────────────────────────────────────────────────────
# For web_search skill: AI-optimized search (use one or leave both unset for URL-only fetch).
# Tavily: https://tavily.com/ (recommended). SerpAPI: https://serpapi.com/
# If neither is set, the skill can still fetch a single URL via payload.url.
# TAVILY_API_KEY=
# SERPAPI_KEY=

# ─────────────────────────────────────────────────────────────────────────────
# OPTIONAL: FUTURE INTEGRATIONS (Bare Metal Scaling)
# ─────────────────────────────────────────────────────────────────────────────
# Phoenix uses these as hooks for external dependency readiness (System Self-Audit).
# If unset, a "Capability Gap" is logged to KB-08 (Absurdity Log) but not flagged as error.

# Distributed Memory/Caching (Speed up KB cross-referencing)
# PAGI_REDIS_URL=redis://127.0.0.1:6379

# Semantic Search (Long-term unstructured memory beyond the 9 slots)
# PAGI_VECTOR_DB_URL=http://127.0.0.1:6333

# External Notifications (Push alerts for Governor Anomalies)
# PAGI_WEBHOOK_URL=https://your-webhook-endpoint.com/notify

# ══════════════════════════════════════════════════════════════════════════════
# UI & CUSTOMIZATION
# ══════════════════════════════════════════════════════════════════════════════
# All server values above (fs_access_enabled, fs_root, llm_mode, llm_model,
# tick_rate_secs, local_context_limit, moe_default) are exposed in the Studio UI
# under Settings → "Server configuration (.env)". Edit .env and restart the
# gateway to change them. MoE (Sparse Intelligence) can be toggled in the UI
# and is persisted to Sovereign Config (KB-6).
# ══════════════════════════════════════════════════════════════════════════════

# ══════════════════════════════════════════════════════════════════════════════
# QUICK START
# ══════════════════════════════════════════════════════════════════════════════
# 1. Copy this file:
#      cp .env.example .env
#
# 2. Add your OpenRouter API key:
#      PAGI_LLM_API_KEY=sk-or-v1-...
#
# 3. Set mode to live:
#      PAGI_LLM_MODE=live
#
# 4. Run pre-flight check:
#      cargo run -p pagi-gateway -- --verify
#
# 5. Start the gateway:
#      cargo run -p pagi-gateway
#
# 6. Start the UI (in another terminal):
#      cd add-ons/pagi-studio-ui/assets/studio-interface && npm run dev
#
# 7. Open http://127.0.0.1:3001
# ══════════════════════════════════════════════════════════════════════════════
